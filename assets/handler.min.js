var ContaoFineUploader={};!function(){"use strict";var e={};ContaoFineUploader.init=function(t,l,a){e[l.field]=document.getElementById("ctrl_"+l.field).value;var n={element:t,debug:!1,request:{endpoint:window.location.href,inputName:l.field+"_fineuploader",params:{action:"fineuploader_upload",name:l.field,REQUEST_TOKEN:l.request_token}},chunking:{enabled:l.chunking?!0:!1,partSize:l.chunkSize},failedUploadTextDisplay:{mode:"custom",maxChars:1e3,responseProperty:"error"},validation:{allowedExtensions:l.extensions,sizeLimit:l.sizeLimit},text:{formatProgress:l.labels.text.formatProgress,failUpload:l.labels.text.failUpload,waitingForResponse:l.labels.text.waitingForResponse,paused:l.labels.text.paused},messages:{tooManyFilesError:l.labels.messages.tooManyFilesError,unsupportedBrowser:l.labels.messages.unsupportedBrowser},retry:{autoRetryNote:l.labels.retry.autoRetryNote},deleteFile:{confirmMessage:l.labels.deleteFile.confirmMessage,deletingStatusText:l.labels.deleteFile.deletingStatusText,deletingFailedText:l.labels.deleteFile.deletingFailedText},paste:{namePromptMessage:l.labels.paste.namePromptMessage},callbacks:{onValidateBatch:function(t){var a=""===e[l.field]?0:e[l.field].split(",").length;return 1==l.limit&&1==t.length&&1==a&&(a=0,e[l.field]="",this.clearStoredFiles()),l.limit>0&&l.limit<a+t.length?(this._batchError(this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,a+t.length).replace(/\{itemLimit\}/g,l.limit)),!1):void 0},onUpload:function(){l.backend&&AjaxRequest.displayBox(Contao.lang.loading+" â€¦")},onComplete:function(t,a,n){return n.success?(n.file&&(e[l.field]=(e[l.field].length?e[l.field]+",":"")+n.file),void(this.getInProgress()>0||(l.backend?new Request.Contao({field:document.getElementById("ctrl_"+l.field),evalScripts:!1,onSuccess:function(e,t){document.getElementById("ctrl_"+l.field).getParent("div").set("html",t.content),t.javascript&&Browser.exec(t.javascript),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"fineuploader_reload",name:l.field,value:e[l.field],REQUEST_TOKEN:l.request_token}):document.getElementById("ctrl_"+l.field).value=e[l.field]))):void(l.backend&&AjaxRequest.hideBox())}}};for(var i in a)n[i]=a[i];return new qq.FineUploader(n)},ContaoFineUploader.deleteItem=function(e,l){var a=e.parentNode,n=a.getAttribute("data-id");t(document.getElementById("ctrl_"+l),n),a.parentNode.removeChild(a)},ContaoFineUploader.makeSortable=function(e,t){var l,a=new Sortables(document.getElementById(e),{contstrain:!0,opacity:.6}).addEvent("complete",function(){var a=[],n=document.getElementById(e).getChildren("li");for(l=0;l<n.length;l++)a.push(n[l].get("data-id"));document.getElementById(t).value=a.join(",")});a.fireEvent("complete")};var t=function(t,l){var a,n=t.value.split(",");for(a=0;a<n.length;a++)if(n[a]==l){n.splice(a,1);break}e[t.id]=n.join(","),t.value=e[t.id]}}();