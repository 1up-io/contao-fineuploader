var ContaoFineUploader={};(function(){"use strict";var e="";ContaoFineUploader.init=function(t,n,r){e=document.id("ctrl_"+n.field).get("value");var i={element:document.id(t),request:{endpoint:window.location.href,inputName:n.field,params:{action:"fineuploader_upload",name:n.field,REQUEST_TOKEN:n.request_token}},failedUploadTextDisplay:{mode:"custom",maxChars:50,responseProperty:"error"},validation:{allowedExtensions:n.extensions,itemLimit:n.limit},callbacks:{onValidateBatch:function(){if(this._options.validation.itemLimit<=e.split(",").length){this._batchError(this._options.messages.tooManyItemsError.replace(/\s\(\{netItems\}\)/g,"").replace(/\{itemLimit\}/g,this._options.validation.itemLimit));return false}},onUpload:function(){if(n.backend){AjaxRequest.displayBox(Contao.lang.loading+" â€¦")}},onComplete:function(t,r,i){if(!i.success){if(n.backend){AjaxRequest.hideBox()}return}if(i.file){e=(e.length?e+",":"")+i.file}if(this.getInProgress()>0){return}(new Request.Contao({field:document.id("ctrl_"+n.field),evalScripts:false,onSuccess:function(e,t){document.id("ctrl_"+n.field).getParent("div").set("html",t.content);t.javascript&&Browser.exec(t.javascript);if(n.backend){AjaxRequest.hideBox()}window.fireEvent("ajax_change")}})).post({action:"fineuploader_reload",name:n.field,value:e,REQUEST_TOKEN:n.request_token})}}};Object.append(i,r);return new qq.FineUploader(i)};ContaoFineUploader.deleteItem=function(e,n){var r=document.id(e).getParent();var i=r.get("data-id");t(document.id("ctrl_"+n),i);r.dispose()};ContaoFineUploader.makeSortable=function(e,t){var n;var r=(new Sortables(document.id(e),{contstrain:true,opacity:.6})).addEvent("complete",function(){var r=[],s=document.id(e).getChildren("li");for(n=0;n<s.length;n++){r.push(s[n].get("data-id"))}document.id(t).value=r.join(",")});r.fireEvent("complete")};var t=function(t,n){var r=t.get("value").split(",");var i;for(i=0;i<r.length;i++){if(r[i]==n){r.splice(i,1);break}}e=r.join(",");t.set("value",e)}})()