var ContaoFineUploader={};(function(){var a="";ContaoFineUploader.init=function(e,d,c){a=document.id("ctrl_"+d.field).get("value");var f={element:document.id(e),request:{endpoint:window.location.href,inputName:d.field,params:{action:"fineuploader_upload",name:d.field,REQUEST_TOKEN:d.request_token}},failedUploadTextDisplay:{mode:"custom",maxChars:1000,responseProperty:"error"},validation:{allowedExtensions:d.extensions,itemLimit:d.limit},callbacks:{onValidateBatch:function(){if(this._options.validation.itemLimit<=a.split(",").length){this._batchError(this._options.messages.tooManyItemsError.replace(/\s\(\{netItems\}\)/g,"").replace(/\{itemLimit\}/g,this._options.validation.itemLimit));return false}},onUpload:function(){if(d.backend){AjaxRequest.displayBox(Contao.lang.loading+" â€¦")}},onComplete:function(i,h,g){if(!g.success){if(d.backend){AjaxRequest.hideBox()}return}if(g.file){a=(a.length?(a+","):"")+g.file}if(this.getInProgress()>0){return}new Request.Contao({field:document.id("ctrl_"+d.field),evalScripts:false,onSuccess:function(j,k){document.id("ctrl_"+d.field).getParent("div").set("html",k.content);k.javascript&&Browser.exec(k.javascript);if(d.backend){AjaxRequest.hideBox()}window.fireEvent("ajax_change")}}).post({action:"fineuploader_reload",name:d.field,value:a,REQUEST_TOKEN:d.request_token})}}};Object.append(f,c);return new qq.FineUploader(f)};ContaoFineUploader.deleteItem=function(c,f){var d=document.id(c).getParent();var e=d.get("data-id");b(document.id("ctrl_"+f),e);d.dispose()};ContaoFineUploader.makeSortable=function(f,d){var c;var e=new Sortables(document.id(f),{contstrain:true,opacity:0.6}).addEvent("complete",function(){var h=[],g=document.id(f).getChildren("li");for(c=0;c<g.length;c++){h.push(g[c].get("data-id"))}document.id(d).value=h.join(",")});e.fireEvent("complete")};var b=function(d,e){var f=d.get("value").split(",");var c;for(c=0;c<f.length;c++){if(f[c]==e){f.splice(c,1);break}}a=f.join(",");d.set("value",a)}})();